"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,r,n=require("react"),t=require("vega"),u=require("vega-lite"),a=(e=require("vega-tooltip"))&&"object"==typeof e&&"default"in e?e.default:e;function i(){return(i=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}require("tiny-warning"),function(e){e.VEGA="vega",e.VEGA_LITE="vega-lite"}(r||(r={}));var o={hover:!0,renderer:"canvas"},l=function(e){var r=n.useState(e),t=r[1],u=n.useRef(r[0]),a=n.useCallback((function(e){u.current=e,t(e)}),[]);return[u,a]};exports.useVega=function(e,c){var f=l(null),v=f[0],d=f[1],s=n.useRef(e),p=n.useRef(null),g=l(!0),y=g[0],E=g[1],A=l(!1),w=A[0],V=A[1],b=n.useState(null),h=b[0],L=b[1],_=n.useCallback((function(e){if(v){if(p.current&&(p.current.finalize(),p.current=null),function(e){return!!(e.data&&e.data.url||!Array.isArray(null==e?void 0:e.data)&&(null==e?void 0:e.data.values)||Array.isArray(null==e?void 0:e.data)&&(null==e?void 0:e.data.length)>0&&(null==e?void 0:e.data[0].name))}(e)){var n=function(e,n,l,c,f){void 0===c&&(c={});var v=void 0;try{v=function(e,n,l,c){if(void 0===l&&(l={}),void 0===c&&(c=r.VEGA_LITE),e&&e.current&&n){var f=i({},o,l,{container:e.current}),v=c===r.VEGA_LITE?u.compile(n).spec:n,d=t.parse(v,n.config),s=new t.View(d,f);return a(s),s}}(n,l,c,f)}catch(e){return e}return function(e){return!!e&&!!(null==e?void 0:e.addDataListener)}(v)?(e.current=v,!1):new Error("Could not load view")}(p,v,e,c?c.overrides:{},(null==c?void 0:c.grammer)||r.VEGA_LITE);n?L(n):(V(!1),L(null))}else V(!0);E(!1)}}),[E,v,c,V]),q=n.useCallback((function(e){e&&d(e)}),[d]);return n.useEffect((function(){if(v.current)return _(s.current||e),function(){p.current&&p.current.finalize()}}),[v,e,_]),{ref:v,view:p,updateView:_,isLoading:y.current,noData:w.current,error:h,updateContainer:q}};
//# sourceMappingURL=use-vega.cjs.production.min.js.map
